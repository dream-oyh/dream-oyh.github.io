---
date: 2024-02-25
---

# NiN（网络中的网络）

::: tip 本节学习要点

1. 掌握 1x1 卷积层代替全连接层的设计思路
2. 学会 1x1 卷积层的定义和使用
3. 了解 NiN 结构的定义
   :::

> What is it NiN?

相较于 LeNet, AlexNet 与 VGG 提供了更为深度的学习网络，能够学习更复杂的特征，但是 AlexNet 与 VGG 的基本结构都是卷积层 + 全连接层，而全连接层作为最后一端，参数过多，计算量大，因此 NiN 提出，将卷积层与全连接层交替排列，减少计算，提高效率。但是问题在于，卷积层的输入输出均为四维数组，可是全连接层的输入输出为二维数组，难以实现，这时候需要用到 1x1 卷积层用来充当全连接层的作用。

## NiN 块

NiN 块与[ VGG 中的 VGG 块 ](4.4VGG.md#定义-vgg-块函数)类似，是 NiN 网络中的基本组成单元，它由一个卷积层加两个充当全连接层的 1x1 卷积层串联而成，第一个卷积层的参数可以自定义，而第二和第三个的卷积层参数一般是固定的。

定义 NiN 块的函数如下：

```python
def nin_block(in_channels, out_channels, kernel_size, padding, stride):
  net = nn.Sequential(
    nn.Conv2d(in_channels, out_channels, kernel_size, padding=padding, stride=stride),
    nn.ReLU(),
    nn.Conv2d(out_channels, out_channels, kernel_size=1),
    nn.ReLU(),
    nn.Conv2d(out_channels, out_channels, kernel_size=1),
  )
  return net
```

## NiN 网络

NiN 使用卷积窗口形状分别为 11×11、5×5 和 3×3 的卷积层，相应的输出通道数也与 [ AlexNet ](4.3AlexNet.md#网络结构) 中的一致。每个 NiN 块后接一个步幅为 2、窗口形状为 3×3 的最大池化层。

NiN 去掉了 AlexNet 最后的 3 个全连接层，取而代之地，NiN 使用了输出通道数等于标签类别数的 NiN 块，然后使用全局平均池化层对每个通道中所有元素求平均并直接用于分类。这里的全局平均池化层即窗口形状等于输入空间维形状的平均池化层。NiN 的这个设计的好处是可以显著减小模型参数尺寸，从而缓解过拟合。然而，该设计有时会造成获得有效模型的训练时间的增加。

> **全局平均池化层**
