# 数学建模

## 数学建模思维导图

<iframe :src="$withBase('/markmap/math.html')" width="100%" height="800" frameborder="0" scrolling="Yes" leftmargin="0" topmargin="0">
</iframe>

:::tip 思维导图使用方法

节点支持收纳与展开

鼠标中键滚动放大缩小

鼠标左键拖动可移动导图
:::

## 综合评价-TOPSIS法

TOPSIS：Technique for Order Preference by Similarity to Ideal Solution)——逼近理想解排序法，或称优劣解距离法

### 层次分析法的局限

1. 评价决策层不能太多，否则n很大，判断矩阵和一致矩阵差异很大

   平均随机一致性指标中n最大为15

2. 若数据已知，topsis会更加客观，层次分析法会更加主观，一般不建议使用

### 指标正向化——统一指标类型

将所有的指标转化为极大型指标称为**指标正向化**

**常见的四种指标**

|指标名称|指标特点|例子|
|:---:|:---:|:---:|
|极大型（效益型）指标|越大（多）越好|成绩、GDP增速、企业利润|
|极小型（成本型）指标|越小（少）越好|费用、坏品率、污染程度|
|中间型指标|越接近某个值越好|水质量评估时的PH值|
|区间型指标|落在某个区间最好|体温、水中植物性营养物量|

-----

- 极小型（成本型）指标

公式：$\~{x_i}=max-X$，若所有元素均为正数（非零），也可以使用$\frac{1}{x}$

- 中间型指标

指标既不要太大，也不要太小，取某特定值最好

假设$\{x_i\}$是一组中间型序列（后同，不赘述），且最佳数值为$x_{best}$，那么正向化公式如下：

$$M=max\{|x_i-x_{best}|\},\~{x_i}=1-\frac{|x_i-x_{best}|}{M}$$



## 相关性分析

- 总体皮尔逊$Pearson$相关系数

对两组总体数据：$X:{X_1,X_2,X_3,\cdots,X_n}$与$Y:{Y_1,Y_2,Y_3,\cdots,Y_n}$

根据《概率论与数理统计》有关知识，总体均值：
$$E(X)=\frac{\sum_{i=1}^{n} X_i}{n}$$

$$E(Y)=\frac{\sum_{i=1}^{n} Y_i}{n}$$

总体协方差：
$$
\begin{align*}
Cov(X,Y)&=\frac{\sum_{i=1}^{n} (X_i-E(X))(Y_i-E(Y))}{n}\\
\\
&=E[(X-E(X))(Y-E(Y))]
\end{align*}
$$

但协方差受两变量的量纲影响，不便于作比较，故需要对其进行标准化，可得总体$Pearson$相关系数：
$$\rho _{XY}=\frac{Cov(X,Y)}{\sigma_X \sigma_Y}=\frac{\sum_{i=1}^{n}\frac{X_i-E(X)}{\sigma_X}\frac{Y_i-E(Y)}{\sigma_Y}}{n}$$

:::tip 为什么这么进行标准化？
1. 从量纲上考虑，$X_i-E(X)$的量纲为$X$的单位$[X]$，$Y_i-E(Y)$的量纲为$Y$的单位$[Y]$，则分子$[X_i-E(X)][Y_i-E(Y)]$的单位为$[X][Y]$。分母$\sigma_X \sigma_Y$的单位也为$[X][Y]$，故起到消除量纲的作用。


2. 可类比正态分布：若$X\sim {}N(\mu,\sigma)$，则
$$\frac{X-\mu}{\sigma}\sim N(0,1)$$
同理，$\frac{X_i-E(X)}{\sigma_X}\frac{Y_i-E(Y)}{\sigma_Y}$可起到标准化作用
:::

而其中，
$$\sigma_X=\sqrt{\frac{\sum_{i=1}^{n}(X_i-E(X))^2}{n}}$$

$$\sigma_Y=\sqrt{\frac{\sum_{i=1}^{n}(Y_i-E(Y))^2}{n}}$$

难证但可以证明：$|\rho_{XY}|\le 1$,（证明过程可以不用管，挺复杂）

且当$Y=aX+b$（即：为线性关系）时，
$$\rho _{XY}=\begin{cases}1,&a>0\\-1,&a<0\end{cases}$$

- 样本皮尔逊$Pearson$相关系数

对两组样本数据：$X:{X_1,X_2,X_3,\cdots,X_n}$与$Y:{Y_1,Y_2,Y_3,\cdots,Y_n}$

根据《概率论与数理统计》有关知识，样本均值：
$$E(X)=\frac{\sum_{i=1}^{n} X_i}{n}$$

$$E(Y)=\frac{\sum_{i=1}^{n} Y_i}{n}$$

样本协方差：
$$
\begin{align*}
Cov(X,Y)&=\frac{\sum_{i=1}^{n} (X_i-E(X))(Y_i-E(Y))}{\textbf{n-1}}
\end{align*}
$$

样本$Pearson$相关系数：
$$r_{XY}=\frac{Cov(X,Y)}{S_X S_Y}=\frac{\sum_{i=1}^{n}\frac{X_i-E(X)}{S_X}\frac{Y_i-E(Y)}{S_Y}}{\textbf{n-1}}$$

其中，
$$S_X=\sqrt{\frac{\sum_{i=1}^{n}(X_i-E(X))^2}{\textbf{n-1}}}$$

$$S_Y=\sqrt{\frac{\sum_{i=1}^{n}(Y_i-E(Y))^2}{\textbf{n-1}}}$$

又：$|r_{XY}|\le 1$,

当$Y=aX+b$时，
$$r_{XY}=\begin{cases}1,&a>0\\-1,&a<0\end{cases}$$

:::tip
样本皮尔逊相关系数与总体皮尔逊相关系数的差别在于相关系数，协方差，方差的分母，总体为$n$，样本为$n-1$。(上文中已标粗显示，具体推导复杂，此处不做记录)
:::

- $Pearson$相关系数的误区

<div style="text-align: center; ">
<img alt="math_1" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_1.jpg" width="500" />
</div>

以上四图，相关系数均为0.816，本应该呈严格线性相关，但却产生不同情况。

`图一`——姑且存在一定线性相关关系

`图二`——二次关系也可能使得相关系数很大

`图三`——离群点对相关系数影响大

`图四`——如果两个编量的相关系数很大也不能说明两者相关，可能存在异常值影响，若无异常点，则$\rho_{XY}=0$，则$X,Y$无关。

<div style="text-align: center; ">
<img alt="math_2" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_2.jpg" width="500" />
</div>

以上情况，表明相关系数为0时，只能说不是线性相关，但可能存在更为复杂的相关关系

:::danger 注意
在计算$Pearson$相关系数之前，需要画出散点图，以确定两个变量之间符合线性相关，这样，$Pearson$相关系数才有意义
:::

- 相关系数结论

1. <text style="color:red;">如果两个变量本身就是线性关系，</text>那么$Pearson$相关系数绝对值大的就是相关性强，小的就是相关性弱

2. 在不确定两个变量是什么关系的情况下，即使算出$Pearson$相关系数，发现很大，也不能说明那两个变量线性相关，甚至不能说他们相关，必须先画出散点图！

- 描述性统计

在拿到一系列数据进行相关性分析之前，需要对数据进行描述性统计，此时，需要借用matlab代码，可见[matlab-描述性统计](/study/code/matlab.html#matlab中基本统计量函数——描述性统计)

- 假设检验

作用：分析**显著性水平**

相关概念：
|概念名称|含义|
|:---:|:---|
|原假设|人为假设出的结论，或者说需要证明，然后去相信的结论|
|备择假设|不相信的假设，与原假设相反|
|显著性水平$\alpha$|我们有多大可能不相信原假设|
|置信水平$\beta$|我们有多大可能相信原假设|

例：小明称体重94斤，但之前都是90斤，进行假设检验，以说明小明是否长胖（即：94~90的变化是否显著）

①确定原假设$H_0$与备择假设$H_1$

$H_0$与$H_1$为恰好相反的两面

我们要检验：这个月体重是否仍为90斤（或者说和90斤体重是否有显著差异，设体重为W），则：

$$\begin{split}
H_0&:W=90\\
H_1&:W\ne 90\\
即：H_1&:\begin{cases}
W>90\\
W<90
\end{cases}
\end{split}$$

注：这种检验称之为双侧检验

②在$H_0$成立的条件下，根据我们要检验的量构造一个符合某一分布的统计量（统计量相当于我们要检验的量的一个函数，里面不能含有其他变量）

$$
\begin{cases}
标准正态分布\\
t分布\\
F分布\\
X^2分布\\
\end{cases}
$$

例：在$H_0:W=90$成立的条件下，设：$W\sim N(90,4)$,标准化后得：$\frac{W-90}{2}\sim N(0,1)$，设$Z=\frac{W-90}{2}$

③画出概率密度函数

<div style="text-align: center; ">
<img alt="概率密度函数" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_3.jpg" width="500" />
</div>

④给出置信水平

例：设我们有95%的可能，相信原假设成立，即：$\alpha =5\%,\beta=95\%$

则需要根据置信可能计算出接受域，拒绝域，可得下图：

<div style="text-align: center; ">
<img alt="概率密度函数" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_4.jpg" width="500" />
</div>

:::tip 1.96如何计算得到
通过查找正态分布表可得：
对于$X\sim N(0,1)$，$f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}$，而若置信水平为95%，则：
$$\int_{-1.96}^{1.96}\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=0.950004$$
即：$[-1.96,1.96]$区间内，概率密度函数所围面积为95%
:::

故：$H_0$成立条件下：
$$P(-1.96\le z\le 1.96)=0.95$$

而真实情况下：
$$z^*=\frac{94-90}{2}=2>1.96$$

所以2落在了0.05的小概率内，小概率事件发生，假设$H_0$不成立。

**进一步理解“置信水平”：**

若此时$\beta=99\%$，通过计算可得，在$[-2.58,2.58]$区间内，概率密度函数所谓面积为$99\%$，即：当真实情况下的$z^*$ 满足 $-2.58\le z^*\le 2.58$时，认为原假设成立。由于2<2.58，此时原假设成立。

所以置信水平越大，假设越容易成立。假设置信水平高达100%，则接受域铺满整个概率密度函数，原假设必定成立。

**若为单侧检验？**

假设单侧检验的原假设与备择假设分别是：

$$\begin{cases}
H_0:W=90\\
H_1:W<90
\end{cases}$$
则此时的积分应为：

$$\int_{-\infty }^{2.33}\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=0.99$$

接受域如下图：

<div style="text-align: center; ">
<img alt="math_5" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_5.jpg" width="500" />
</div>

当真实情况下$z^*\le 2.33$时，我们有99%的可能相信原假设成立。

- 对相关系数进行假设检验

Why？对相关系数的解释是依赖于具体背景与应用目的的，单从数值角度进行主观判断是不准确的，需要依赖假设检验进行显著性检测，以确认线性关系。

①构造原假设$H_0$与备择假设$H_1$

计算出$Pearson$相关系数后，需要计算其是否显著地异于0，故构造：

$$
\begin{cases}
H_0:r=0\\
H_1:r\ne 0\\
\end{cases}
$$

②构造服从某分布的检验量

对于皮尔逊相关系数$r$而言，**在一定条件下**，可以构造：
$$t=r\sqrt{\frac{n-2}{1-r^2}}$$
其中，n为样本量，t服从自由度为n-2的t分布。

(这里的条件见后文~)

:::tip 何为t分布？
t分布：采样较少时，得出有用结果，所以t分布相对于正态分布容错率更高

关键点：用样本标准差代替整体标准差

但是样本标准差会随着样本的选取而改变，而总体标准差是个定值，以变量代替定值必然造成更大的不确定性，故采取t分布以消除此不确定性。**也因此，在t分布自由度(样本数-1为自由度)足够高的情况下，t分布会趋近正态分布，这也是传说中的“中心极限定理”**，一般认为标准差＞30时，t分布近似等于正态分布
:::

③画出概率密度函数

<div style="text-align: center; ">
<img alt="math_6" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_6.jpg" width="500" />
</div>

④给出置信水平

例：相关系数为0.5，置信水平为95%，样本为30，通过查找t分布表可得：
$$\int_{-2.048}^{2.048} f(t)dt=0.95$$

即：临界值为2.048。

此时，真实情况下，
$$t^*=r\sqrt{\frac{n-2}{1-r^2}}=0.5*\sqrt{\frac{28}{1-0.5^2}}=3.055>2.048$$

<div style="text-align: center; ">
<img alt="math_7" src="https://cdn.statically.io/gh/dream-oyh/dream-oyh.github.io/images/math_7.jpg" width="500" />
</div>

故r落在拒绝域内，故我们有95%的可能拒绝原假设$H_0:r=0$，即：r显著的不等于0，线性相关性强。

- 另外一种方法进行假设检验——P值法

方法论：

①构造原假设与备择假设，构造分布，画出概率密度函数与上同

②计算真实情况下的$z^*$

如上例所示，
$$t^*=r\sqrt{\frac{n-2}{1-r^2}}=0.5*\sqrt{\frac{28}{1-0.5^2}}=3.055$$

③计算概率密度函数图中$[t^*,+\infty]$区间内图像所围面积

$$P\{x\le t^*\}=\int_{t^*}^{+\infty}f(t)dt$$

比较面积与接受域的大小，可得下面结论：
:::details 结论
$$\begin{align}
&对于置信水平90\%的双侧检验，&若2p\le 0.1，即：p\le 0.05，则拒绝原假设，\\&反之，&若p\ge 0.05，则接受原假设；\\

&对于置信水平95\%的双侧检验，&若2p\le 0.05，即：p\le 0.025，则拒绝原假设，\\&反之，&若p\ge 0.025，则接受原假设；\\

&对于置信水平99\%的双侧检验，&若2p\le 0.01，即：p\le 0.005，则拒绝原假设，\\&反之，&若p\ge 0.005，则接受原假设；\\
\\
&对于置信水平90\%的单侧检验，&若p\le 0.1，则拒绝原假设，\\&反之，&若p\ge 0.1，则接受原假设；\\

&对于置信水平95\%的单侧检验，&若p\le 0.05，则拒绝原假设，\\&反之，&若p\ge 0.05，则接受原假设；\\

&对于置信水平99\%的单侧检验，&若p\le 0.01，则拒绝原假设，\\&反之，&若p\ge 0.99，则接受原假设；\\
\end{align}
$$
:::

对本题而言：
$$P\{x\ge t^*\}=\int_{3.055}^{+\infty }f(t)dt\le 0.025$$

拒绝原假设，即：相关系数$r$显著地不等于0。